knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
genotypes<-read.table('resources/genotypes.txt',header=T)
getwd()
genotypes<-read.table('resources/genotypes.txt',header=T)
genotypes<-read.table('ressources/genotypes.txt',header=T)
phenotypes<-read.table('ressources/phenotypes.txt', header=T)
variants.info<-read.table('ressources/variants_info_openSNP.txt',header=T)
covariates<-read.table('ressources/covariates.txt',header=T)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
genotypes<-read.table('ressources/genotypes.txt',header=T)
phenotypes<-read.table('ressources/phenotypes.txt', header=T)
variants.info<-read.table('ressources/variants_info_openSNP.txt',header=T)
covariates<-read.table('ressources/covariates.txt',header=T)
covariates.pheno<-cbind(covariates,phenotypes$HEIGHT)
rownames(covariates.pheno)<-covariates$CHALLENGE_ID
covariates.pheno<-covariates.pheno[,-1]
colnames(covariates.pheno)<-c('SEX','PLATFORM','HEIGHT')
lin.reg.cov<-lm(HEIGHT~., data=covariates.pheno)
summary(lin.reg.cov)
ggplot(phenotypes)+geom_density(aes(HEIGHT),size=1)+theme_bw()
covariates.pheno.M<-covariates.pheno[apply(covariates.pheno,1,function(x) x[1]=='M'),]
covariates.pheno.F<-covariates.pheno[apply(covariates.pheno,1,function(x) x[1]=='F'),]
ggplot()+geom_density(data=covariates.pheno,aes(HEIGHT,color='male+female'),size=1.1)+
geom_density(data=covariates.pheno.M,aes(HEIGHT,color='male'),size=0.8)+
geom_density(data=covariates.pheno.F,aes(HEIGHT,color='female'),size=0.8)+ theme_bw()
gwas<-function(SNP,phenos=phenotypes$HEIGHT){
df<-data.frame(cbind(SNP,phenos))
colnames(df)<-c('SNP','HEIGHT')
fit<-lm(HEIGHT~.,data=df)
summary.coefs<-summary(fit)$coefficient
data.frame(coef=summary.coefs[2,1],pval=summary.coefs[2,4])
}
gwas.with.cov<-function(SNP,cov=covariates.pheno){
df<-data.frame(cbind(SNP,cov))
colnames(df)<-c('SNP',colnames(covariates.pheno))
fit<-lm(HEIGHT~.,data=df)
summary.coefs<-summary(fit)$coefficients
print(head(summary.coefs))
data.frame(coef=summary.coefs[2,1],pval=summary.coefs[2,4])
}
gwas.res<-data.frame(coef=NULL,pval=NULL)
for(i in 1:ncol(genotypes)){
gwas.res<-rbind(gwas.res,gwas(genotypes[,i]))
}
rownames(gwas.res)<-colnames(genotypes)
gwas.res.with.cov<-data.frame(coef=NULL,pval=NULL)
for(i in 1:ncol(genotypes)){
gwas.res.with.cov<-rbind(gwas.res.with.cov,gwas.with.cov(genotypes[,i]))
}
gwas<-function(SNP,phenos=phenotypes$HEIGHT){
df<-data.frame(cbind(SNP,phenos))
colnames(df)<-c('SNP','HEIGHT')
fit<-lm(HEIGHT~.,data=df)
summary.coefs<-summary(fit)$coefficient
data.frame(coef=summary.coefs[2,1],pval=summary.coefs[2,4])
}
gwas.with.cov<-function(SNP,cov=covariates.pheno){
df<-data.frame(cbind(SNP,cov))
colnames(df)<-c('SNP',colnames(covariates.pheno))
fit<-lm(HEIGHT~.,data=df)
summary.coefs<-summary(fit)$coefficients
data.frame(coef=summary.coefs[2,1],pval=summary.coefs[2,4])
}
gwas.res<-data.frame(coef=NULL,pval=NULL)
for(i in 1:ncol(genotypes)){
gwas.res<-rbind(gwas.res,gwas(genotypes[,i]))
}
rownames(gwas.res)<-colnames(genotypes)
gwas.res.with.cov<-data.frame(coef=NULL,pval=NULL)
for(i in 1:ncol(genotypes)){
gwas.res.with.cov<-rbind(gwas.res.with.cov,gwas.with.cov(genotypes[,i]))
}
rownames(gwas.res.with.cov)<-colnames(genotypes)
q()
